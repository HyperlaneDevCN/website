<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://hyperlane.cc/blog/</id>
    <title>Hyperlane 中文社区 Blog</title>
    <updated>2025-04-11T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://hyperlane.cc/blog/"/>
    <subtitle>Hyperlane 中文社区 Blog</subtitle>
    <icon>https://hyperlane.cc/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Hyperlane 深度解析（3）：构建跨链通信实践—乒乓球示例]]></title>
        <id>https://hyperlane.cc/blog/in-depth-analysis-03/</id>
        <link href="https://hyperlane.cc/blog/in-depth-analysis-03/"/>
        <updated>2025-04-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[构建跨链通信实践—乒乓球示例]]></summary>
        <content type="html"><![CDATA[<p>本文将通过一个实际示例，演示如何通过Hyperlane 协议发送跨链消息 。</p>
<p>你将学习如何：</p>
<ul>
<li>部署与 Hyperlane Mailbox 兼容的合约</li>
<li>部署可信中继器 ISM (跨链安全模块)</li>
<li>运行一个简单的中继器</li>
<li>发送跨链消息</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例概览">示例概览<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E7%A4%BA%E4%BE%8B%E6%A6%82%E8%A7%88" class="hash-link" aria-label="示例概览的直接链接" title="示例概览的直接链接">​</a></h2>
<p>在此示例中，您将在两个不同的链上部署类似的合约。链 A 上的合约将使用 Hyperlane 协议 向链 B 发送一条消息，链 B 上的合约将处理此消息并回复链 A。</p>
<p><img decoding="async" loading="lazy" alt="Ping Pong Flow" src="https://hyperlane.cc/assets/images/pingpong-flow-6c871f9e5ca11c65ad5a21b6e7fbbd32.png" width="1600" height="991" class="img_ev3q"></p>
<p>合约主要功能：</p>
<ul>
<li><code>sendPing</code><em>：通过调用Hyperlane</em>的方法 来发起跨链消息<code>IMailbox.dispatch</code>。</li>
<li><code>enrollRemoteRouter</code>：在继承的<code>Router</code>合约中，注册来自另一条链的合约。</li>
<li><code>setInterchainSecurityModule</code>：设置合同的 ISM。</li>
<li><code>_handle</code>：处理来自邮箱的传入消息（继承的<code>Router</code>合约<code>handle</code>函数调用的内部函数）。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="开发环境准备">开发环境准备<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" class="hash-link" aria-label="开发环境准备的直接链接" title="开发环境准备的直接链接">​</a></h2>
<ol>
<li>
<p>创建并导航到新目录：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> hyperlane-pingpong </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> hyperlane-pingpong</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>初始化 Hardhat 项目并安装依赖项：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npx hardhat init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>添加<a href="https://www.npmjs.com/package/@hyperlane-xyz/core" target="_blank" rel="noopener noreferrer"><code>@hyperlane-xyz/core</code></a>为依赖项：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> @hyperlane-xyz/core</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试代币">测试代币<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E6%B5%8B%E8%AF%95%E4%BB%A3%E5%B8%81" class="hash-link" aria-label="测试代币的直接链接" title="测试代币的直接链接">​</a></h3>
<p>确保你有足够的测试令牌<code>Arbitrum Sepolia</code>，并且<code>Sapphire Testnet</code></p>
<p>获取更多信息：</p>
<ul>
<li><code>Sapphire Testnet</code>来自<a href="https://faucet.testnet.oasis.io/" target="_blank" rel="noopener noreferrer">Oasis Faucet 的</a>测试代币。</li>
<li><code>Arbitrum Sepolia</code>来自 Alchemy 的<a href="https://faucets.alchemy.com/faucets/arbitrum-sepolia" target="_blank" rel="noopener noreferrer">Faucet</a>的ETH 代币。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="将网络添加到-hardhat">将网络添加到 Hardhat<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%B0%86%E7%BD%91%E7%BB%9C%E6%B7%BB%E5%8A%A0%E5%88%B0-hardhat" class="hash-link" aria-label="将网络添加到 Hardhat的直接链接" title="将网络添加到 Hardhat的直接链接">​</a></h3>
<p>打开<code>hardhat.config.ts</code>并添加 Arbitrum Sepolia 和 Sapphire 测试网。</p>
<p>hardhat.config.ts</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> HardhatUserConfig </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat/config"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@nomicfoundation/hardhat-toolbox"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> accounts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PRIVATE_KEY</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PRIVATE_KEY</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> config</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HardhatUserConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  solidity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0.8.24"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">'arbitrum-sepolia'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'https://arbitrum-sepolia-rpc.publicnode.com'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      chainId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">421614</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">'sapphire-testnet'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://testnet.sapphire.oasis.io"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      chainId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23295</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 0x5aff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="乒乓球合约">乒乓球合约<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E4%B9%92%E4%B9%93%E7%90%83%E5%90%88%E7%BA%A6" class="hash-link" aria-label="乒乓球合约的直接链接" title="乒乓球合约的直接链接">​</a></h2>
<p>在此示例中，我们利用了<em>Hyperlane</em><code>Router</code>中的包装器。这具有以下优势：</p>
<ul>
<li><em>合约与Hyperlane</em>的<strong>MailboxClient</strong>和<strong>IMessageRecipient</strong>接口兼容 。</li>
<li>支持<em>注册</em>其他链的路由器。</li>
<li>支持设置<strong>自定义 ISM</strong>。</li>
</ul>
<ol>
<li>
<p><code>Ping.sol</code>创建一个名为Arbitrum Sepolia 的新文件</p>
</li>
<li>
<p>将以下合同粘贴到其中：</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// SPDX-License-Identifier: Apache-2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity </span><span class="token operator" style="color:#393A34">^</span><span class="token number" style="color:#36acaa">0.8</span><span class="token number" style="color:#36acaa">.13</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ============ External Imports ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Router</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/client/Router.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">* @title Ping</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">* @dev You can use this simple app as a starting point for your own application.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract Ping </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> Router </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A generous upper bound on the amount of gas to use in the handle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// function when a message is processed. Used for paying for gas.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> constant </span><span class="token constant" style="color:#36acaa">HANDLE_GAS_AMOUNT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50_000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A counter of how many messages have been sent from this contract.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> sent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A counter of how many messages have been received by this contract.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> received</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Keyed by domain, a counter of how many messages that have been sent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// from this contract to the domain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint32 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> sentTo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Keyed by domain, a counter of how many messages that have been received</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// by this contract from the domain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint32 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> receivedFrom</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ Events ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">SentPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">ReceivedPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">HandleGasAmountSet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 handleGasAmount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address _mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Router</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Transfer ownership of the contract to deployer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">_transferOwnership</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">setHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ External functions ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Sends a message to the _destinationDomain. Any msg.value is</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * used as interchain gas payment.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_destinationDomain</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The destination domain to send the message to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_message</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The message to send.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sendPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> payable </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sent </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sentTo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">_dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit </span><span class="token function" style="color:#d73a49">SentPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">localDomain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Fetches the amount of gas that will be used when a message is</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * dispatched to the given domain.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">quoteDispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> external view </span><span class="token function" style="color:#d73a49">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_quoteDispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ Internal functions ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Handles a message from a remote router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@dev</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Only called for messages sent from a remote router, as enforced by Router.sol.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_origin</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The domain of the origin of the message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_sender</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The sender of the message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_message</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The message body.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> internal override </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        received </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receivedFrom</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">_origin</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit </span><span class="token function" style="color:#d73a49">ReceivedPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">localDomain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>Pong.sol</code>创建一个名为Sapphire Testnet 的新文件</p>
</li>
<li>
<p>将以下合同粘贴到其中：</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// SPDX-License-Identifier: Apache-2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity </span><span class="token operator" style="color:#393A34">^</span><span class="token number" style="color:#36acaa">0.8</span><span class="token number" style="color:#36acaa">.13</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ============ External Imports ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Router</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/client/Router.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">* @title Pong</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">* @dev You can use this simple app as a starting point for your own application.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract Pong </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> Router </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A generous upper bound on the amount of gas to use in the handle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// function when a message is processed. Used for paying for gas.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> constant </span><span class="token constant" style="color:#36acaa">HANDLE_GAS_AMOUNT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50_000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A counter of how many messages have been sent from this contract.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> sent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A counter of how many messages have been received by this contract.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> received</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Keyed by domain, a counter of how many messages that have been sent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// from this contract to the domain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint32 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> sentTo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Keyed by domain, a counter of how many messages that have been received</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// by this contract from the domain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint32 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> receivedFrom</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ Events ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">SentPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">ReceivedPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event </span><span class="token function" style="color:#d73a49">HandleGasAmountSet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 indexed destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 handleGasAmount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address _mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Router</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Transfer ownership of the contract to deployer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">_transferOwnership</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">setHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ External functions ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Sends a message to the _destinationDomain. Any msg.value is</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * used as interchain gas payment.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_destinationDomain</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The destination domain to send the message to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_message</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The message to send.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sendPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">string</span><span class="token plain"> calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> payable </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sent </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sentTo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">_dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit </span><span class="token function" style="color:#d73a49">SentPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">localDomain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Fetches the amount of gas that will be used when a message is</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * dispatched to the given domain.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">quoteDispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> external view </span><span class="token function" style="color:#d73a49">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_quoteDispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ============ Internal functions ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@notice</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Handles a message from a remote router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@dev</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> Only called for messages sent from a remote router, as enforced by Router.sol.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_origin</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The domain of the origin of the message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_sender</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The sender of the message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">_message</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> The message body.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint32 _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> internal override </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        received </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        receivedFrom</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">_origin</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit </span><span class="token function" style="color:#d73a49">ReceivedPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">localDomain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// send return message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sendPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ism合同">ISM合同<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#ism%E5%90%88%E5%90%8C" class="hash-link" aria-label="ISM合同的直接链接" title="ISM合同的直接链接">​</a></h2>
<p>在当前状态下，如果您从 <code>Sapphire Testnet</code> 向<code>Arbitrum Sepolia</code>发送消息，邮箱的默认 ISM将不会接受该消息。您可以在<code>Arbitrum Sepolia</code> 上部署和注册自定义 ISM 以使其正常工作。</p>
<p><em>Hyperlane</em>的一个简单默认 ISM是<strong>TrustedRelayerISM</strong>，它在传递消息之前检查中继器地址。</p>
<ol>
<li>
<p>创建一个名为<code>TrustedRelayerIsm.sol</code></p>
</li>
<li>
<p>将以下合同粘贴到其中：</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// SPDX-License-Identifier: MIT OR Apache-2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token number" style="color:#36acaa">0.8</span><span class="token number" style="color:#36acaa">.0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ============ Internal Imports ============</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">IInterchainSecurityModule</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/interfaces/IInterchainSecurityModule.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Address</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@openzeppelin/contracts/utils/Address.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Message</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/libs/Message.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Mailbox</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/Mailbox.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">PackageVersioned</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"@hyperlane-xyz/core/contracts/PackageVersioned.sol"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract TrustedRelayerIsm </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> IInterchainSecurityModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PackageVersioned </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using Message </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint8 </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> immutable moduleType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uint8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mailbox </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> immutable mailbox</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> immutable trustedRelayer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address _mailbox</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> address _trustedRelayer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _trustedRelayer </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">"TrustedRelayerIsm: invalid relayer"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isContract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">"TrustedRelayerIsm: invalid mailbox"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mailbox </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Mailbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        trustedRelayer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _trustedRelayer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">verify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes calldata message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> external view </span><span class="token function" style="color:#d73a49">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">processor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> trustedRelayer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="部署合约">部署合约<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6" class="hash-link" aria-label="部署合约的直接链接" title="部署合约的直接链接">​</a></h2>
<p>分别在 <code>Sapphire Testnet</code>和 <code>Arbitrum Sepolia</code> 两个不同的链上部署 Ping 和 Pong 合约。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="将-pong-部署到-sapphire-testnet">将 Pong 部署到 Sapphire Testnet<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%B0%86-pong-%E9%83%A8%E7%BD%B2%E5%88%B0-sapphire-testnet" class="hash-link" aria-label="将 Pong 部署到 Sapphire Testnet的直接链接" title="将 Pong 部署到 Sapphire Testnet的直接链接">​</a></h3>
<ol>
<li>
<p><code>deploypong.ts</code>在以下位置创建部署脚本<code>scripts/</code>：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// deployed mailbox on Sapphire Testnet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mailbox </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x79d3ECb26619B968A68CE9337DfE016aeA471435"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">PongFactory</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> hre</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Pong"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pong </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token maybe-class-name">PongFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deploy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pongAddr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> pong</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">waitForDeployment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Pong deployed at: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">pongAddr</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">target</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/deploypong.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> sapphire-testnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="将-ping-部署到-arbitrum-sepolia">将 Ping 部署到 Arbitrum Sepolia<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%B0%86-ping-%E9%83%A8%E7%BD%B2%E5%88%B0-arbitrum-sepolia" class="hash-link" aria-label="将 Ping 部署到 Arbitrum Sepolia的直接链接" title="将 Ping 部署到 Arbitrum Sepolia的直接链接">​</a></h3>
<ol>
<li>
<p><code>deployping.ts</code>在以下位置创建部署脚本<code>scripts/</code>：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// default mailbox on Arbitrum Sepolia</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mailbox </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x598facE78a4302f11E3de0bee1894Da0b2Cb71F8"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">PingFactory</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Ping"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token maybe-class-name">PingFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deploy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mailbox</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pingAddr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ping</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">waitForDeployment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Ping deployed at: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">pingAddr</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">target</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/deployping.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> arbitrum-sepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="部署-ism-到-arbitrum-sepolia">部署 ISM 到 Arbitrum Sepolia<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E9%83%A8%E7%BD%B2-ism-%E5%88%B0-arbitrum-sepolia" class="hash-link" aria-label="部署 ISM 到 Arbitrum Sepolia的直接链接" title="部署 ISM 到 Arbitrum Sepolia的直接链接">​</a></h3>
<ol>
<li>
<p><code>deployISM.ts</code>在以下位置创建部署脚本<code>scripts/</code>：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// default mailbox on Arbitrum Sepolia</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mailbox </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x598facE78a4302f11E3de0bee1894Da0b2Cb71F8"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> trustedRelayer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your relayer address&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> trustedRelayerISM </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deployContract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"TrustedRelayerIsm"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mailbox</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trustedRelayer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> trustedRelayerISM</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">waitForDeployment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">TrustedRelayerISM deployed to </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">trustedRelayerISM</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">target</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/deployISM.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> arbitrum-sepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="合约设置">合约设置<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%90%88%E7%BA%A6%E8%AE%BE%E7%BD%AE" class="hash-link" aria-label="合约设置的直接链接" title="合约设置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注册路由器--router">注册路由器  <code>Router</code><a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1%E5%99%A8--router" class="hash-link" aria-label="注册路由器--router的直接链接" title="注册路由器--router的直接链接">​</a></h3>
<p>由于我们将路由器包装器用于我们的 Ping Pong 合约，因此我们需要登记对方合约的合约地址。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在-sapphire-testnet-上注册-router">在 Sapphire Testnet 上注册 Router<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%9C%A8-sapphire-testnet-%E4%B8%8A%E6%B3%A8%E5%86%8C-router" class="hash-link" aria-label="在 Sapphire Testnet 上注册 Router的直��接链接" title="在 Sapphire Testnet 上注册 Router的直接链接">​</a></h4>
<ol>
<li>
<p><code>enroll.ts</code>在文件夹中创建一个名为<code>/scripts</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> pingpongArbitrum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> pingpongSapphire </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> arbId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"421614"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Pong"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sapphireAddr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">enrollRemoteRouter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arbId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">zeroPadValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pingpongArbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> arbRouter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">routers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arbId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">remote router adr for </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arbId</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arbRouter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/enroll.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> sapphire-testnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在-arbitrum-sepolia-上注册-router">在 Arbitrum Sepolia 上注册 Router<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%9C%A8-arbitrum-sepolia-%E4%B8%8A%E6%B3%A8%E5%86%8C-router" class="hash-link" aria-label="在 Arbitrum Sepolia 上注册 Router的直接链接" title="在 Arbitrum Sepolia 上注册 Router的直接链接">​</a></h4>
<ol>
<li>
<p><code>enroll.ts</code>在文件夹中创建一个名为<code>/scripts</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> pingpongArbitrum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> pingpongSapphire </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> sapphireId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"23295"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Ping"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pingpongArbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">enrollRemoteRouter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sapphireId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">zeroPadValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pingpongSapphire</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> arbRouter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">routers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sapphireId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">remote router adr for </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">sapphireId</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arbRouter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/enroll.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> arbitrum-sepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在-arbitrum-sepolia-注册-ism">在 Arbitrum Sepolia 注册 ISM<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E5%9C%A8-arbitrum-sepolia-%E6%B3%A8%E5%86%8C-ism" class="hash-link" aria-label="在 Arbitrum Sepolia 注册 ISM的直接链接" title="在 Arbitrum Sepolia 注册 ISM的直接链接">​</a></h4>
<ol>
<li>
<p><code>registerIsm.ts</code>在文件夹中创建一个名为<code>/scripts</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> pingpongArbitrum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> ismAddr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your ISM contract deployed before&gt;"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Ping"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pingpongArbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setInterchainSecurityModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ismAddr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代��码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行部署</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/registerIsm.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> arbitrum-sepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="运行中继器">运行中继器<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%BB%A7%E5%99%A8" class="hash-link" aria-label="运行中继器的直接链接" title="运行中继器的直接链接">​</a></h2>
<p>在开始测试 Ping Pong 之前，请确保你在 Arbitrum Sepolia 和 Sapphire Testnet 上运行了一个 Relayer。</p>
<p>运行中继器的最简单方法是使用 <strong><a href="https://docs.hyperlane.xyz/docs/reference/cli" target="_blank" rel="noopener noreferrer">Hyperlane CLI</a></strong>。</p>
<ol>
<li>
<p>导出要与 CLI 一起使用的私钥</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">HYP_KEY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'&lt;YOUR_PRIVATE_KEY&gt;'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>启动一个中继器 监视<code>Arbitrum Sepolia</code> &amp; <code>SapphireTestnet</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hyperlane relayer </span><span class="token parameter variable" style="color:#36acaa">--chains</span><span class="token plain"> sapphiretestnet,arbitrumsepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>链配置</p>
<p><code>Sapphire Testnet</code><em>已在Hyperlane Registry</em>中注册，如果你自己部署Hyperlane <em>Core</em><code>Sapphire Testnet</code>，请确保你拥有 类似于下面的 <em>Hyperlane</em><code>$HOME/.hyperlane/chains/sapphiretestnet</code>配置文件。</p>
<ul>
<li>
<p>metadata.yaml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># yaml-language-server: $schema=../schema.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">blockExplorers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiUrl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//nexus.oasis.io/v1/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">family</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> other</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Oasis Explorer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//explorer.oasis.io/testnet/sapphire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">chainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23295</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Sapphire Testnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">domainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23295</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">isTestnet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sapphiretestnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">nativeToken</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">decimals</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TEST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">symbol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TEST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ethereum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rpcUrls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//testnet.sapphire.oasis.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">technicalStack</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> other</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>addresses.yaml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">domainRoutingIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x3497967f8E5041f486eC559E6B760d8f051A034C"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">interchainAccountIsm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0xD84DE931A0EDA06Af3944a4e9933c24f3B56DCaC"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">interchainAccountRouter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0xFdca43771912CE5F5B4D869B0c05df0b6eF8aEFc"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">mailbox</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x79d3ECb26619B968A68CE9337DfE016aeA471435"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">proxyAdmin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x5Ed8004e3352df333901b0B2E98Bd98C3B4AA59A"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticAggregationHookFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x212c232Ee07E187CF9b4497A30A3a4D034aAC4D6"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticAggregationIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0xE25A539AdCa1Aac56549997f2bB88272c5D9498c"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticMerkleRootMultisigIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x9851EC4C62943E9974370E87E93CE552abE7705E"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticMerkleRootWeightedMultisigIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x688dE6d0aBcb60a711f149c274014c865446b49D"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticMessageIdMultisigIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0xFE0937b1369Bbba59211c4119B91984FF450ccf1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">staticMessageIdWeightedMultisigIsmFactory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x1de05675c8cd512A30c17Ea0a3491d74eF290994"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">testRecipient</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x7bf548104F8f500C563Aa6DC7FbF3b1ad93E4E03"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">validatorAnnounce</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0xB119f96a106919489b6495128f30e7088e55B05c"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>对于更复杂的验证器和中继器设置，请查看 Hyperlane 的 <strong><a href="https://docs.hyperlane.xyz/docs/guides/deploy-hyperlane-local-agents" target="_blank" rel="noopener noreferrer">本地代理指南</a></strong> 或更适合生产的 <strong><a href="https://docs.hyperlane.xyz/docs/operate/overview-agents" target="_blank" rel="noopener noreferrer">代理操作员指南</a></strong>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="执行乒乓球">执行乒乓球<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E6%89%A7%E8%A1%8C%E4%B9%92%E4%B9%93%E7%90%83" class="hash-link" aria-label="执行乒乓球的直接链接" title="执行乒乓球的直接链接">​</a></h2>
<p>要执行，您将调用 Ping.sol 合约的 <code>sendPing</code>函数。</p>
<p>在示例中，<code>demo-opl</code>您可以使用提供的<code>send-ping</code>任务，也可以使用以下脚本：</p>
<ol>
<li>
<p><code>sendping.ts</code>在文件夹中创建一个名为<code>/scripts</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> destChainId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"23295"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> message </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Hello OPL"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pingpongArbitrum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your pingpong contract deployed on arbitrum sepolia"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Ping"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pingpongArbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Calculating fee..."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> fee </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">quoteDispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      destChainId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      hre</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toUtf8Bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Fee: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">hre</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">ethers</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation method function property-access" style="color:#d73a49">formatEther</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation">fee</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c"> ETH</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Sending message..."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> tx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sendPing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">destChainId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> fee</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Message sent"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行脚本</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/sendping.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> arbitrum-sepolia</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="验证乒乓">验证乒乓<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E9%AA%8C%E8%AF%81%E4%B9%92%E4%B9%93" class="hash-link" aria-label="验证乒乓的直接链接" title="验证乒乓的直接链接">​</a></h2>
<p>验证跨链消息传递的最简单方法是检查区块链浏览器并检查已部署 <code>Ping</code> 合约上的交易。</p>
<p>如果您想直接监视事件，可以使用以下脚本：</p>
<ol>
<li>
<p><code>verifyping.ts</code>在文件夹中创建一个名为<code>/scripts</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> ethers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"hardhat"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contractAddr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0x&lt;your deployed ping contract on arbitrum sepolia&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> signer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getContractAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Ping"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> contractAddr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> spinner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'-'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'\\'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'|'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> spinnerIndex </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> interval </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stdout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">\rListing for event... </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">spinner</span><span class="token template-string interpolation punctuation" style="color:#393A34">[</span><span class="token template-string interpolation">spinnerIndex</span><span class="token template-string interpolation punctuation" style="color:#393A34">]</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      current </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spinnerIndex </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> spinner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">do</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> block </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBlockNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">queryFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'ReceivedPing'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> block </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'latest'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resolve</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">clearInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stdout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">\r</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stdout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">clearLine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> parsedEvent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">interface</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseLog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> message </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parsedEvent</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">args</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Message received with: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exitCode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>运行脚本</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> hardhat run scripts/verifyping.ts </span><span class="token parameter variable" style="color:#36acaa">--network</span><span class="token plain"> sapphire-testnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="故障排除">故障排除<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4" class="hash-link" aria-label="故障排除的直接链接" title="故障排除的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="中继器不中继消息">中继器不中继消息<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E4%B8%AD%E7%BB%A7%E5%99%A8%E4%B8%8D%E4%B8%AD%E7%BB%A7%E6%B6%88%E6%81%AF" class="hash-link" aria-label="中继器不中继消息的直接链接" title="中继器不中继消息的直接链接">​</a></h3>
<p>查看：</p>
<ul>
<li><code>enrollRemoteRouter</code> 您已通过以下方式注册了对面的路由器合约：<code>ping.routers(oppositeChainId)</code></li>
<li><code>Arbitrum Sepolia</code>您已通过调用以下方式在 Ping 合约上设置了自定义 ISM<code>ping.interchainSecurityModule</code></li>
<li>中继器地址与受信任的 ISM 配置相匹配。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="无法验证消息">无法验证消息<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E6%97%A0%E6%B3%95%E9%AA%8C%E8%AF%81%E6%B6%88%E6%81%AF" class="hash-link" aria-label="无法验证消息的直接链接" title="无法验证消息的直接链接">​</a></h3>
<p>查看：</p>
<ul>
<li>您的 Hardhat RPC 允许历史事件查询。</li>
<li>如果有必要，请使用专用的 RPC 提供程序（例如 Alchemy）。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="版权声明">版权声明<a href="https://hyperlane.cc/blog/in-depth-analysis-03/#%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E" class="hash-link" aria-label="版权声明的直接链接" title="版权声明的直接链接">​</a></h2>
<p>本文源自 <a href="https://docs.oasis.io/build/opl/hyperlane/pingpong-example/" target="_blank" rel="noopener noreferrer">Ping Pong Example</a> by <a href="https://docs.oasis.io/" target="_blank" rel="noopener noreferrer">Oasis</a>，在其基础上翻译成中文并作出一些调整，你可以在 Oasis 的 <a href="https://github.com/oasisprotocol/demo-opl/tree/main/examples/hyperlane-pingpong" target="_blank" rel="noopener noreferrer">demo-opl 存储库</a>中找到用于部署和执行的合约源代码和 Hardhat 配置。</p>]]></content>
        <author>
            <name>国子</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <author>
            <name>hyperlane 中文</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <category label="hyperlane" term="hyperlane"/>
        <category label="跨链桥" term="跨链桥"/>
        <category label="通信实践" term="通信实践"/>
        <category label="示例" term="示例"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hyperlane 发币在即，详解空投标准和 HYPER 代币机制]]></title>
        <id>https://hyperlane.cc/blog/Hyperlane_Airdrop/</id>
        <link href="https://hyperlane.cc/blog/Hyperlane_Airdrop/"/>
        <updated>2025-04-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hyperlane 空投机制详解]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" src="https://image.yaco.email/hyperlane_airdrop%20(1).png" alt="hyperlane_airdrop (1)" class="img_ev3q"></p>
<p>我们即将迈入扩张的全新阶段，HYPER 将成为驱动 Hyperlane 网络运转的原生代币。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="变革孕育于希望"><em>变革孕育于希望</em><a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E5%8F%98%E9%9D%A9%E5%AD%95%E8%82%B2%E4%BA%8E%E5%B8%8C%E6%9C%9B" class="hash-link" aria-label="变革孕育于希望的直接链接" title="变革孕育于希望的直接链接">​</a></h3>
<p>变革的希望。自由的希望。更好未来的希望。</p>
<p>加密货币曾许下的愿景意义非凡——我们曾被承诺构建开放金融基础设施，以抗衡中心化体系。然而现实却介于理想与妥协之间。尽管无需许可的加密经济蓬勃发展，但随着生态扩张，它们愈发依赖中心化跨链桥与互操作性网络实现连接。</p>
<p>如今数百条链并存，却大多受困于这些中心化的桎梏。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-承载着全新的希望"><em>Hyperlane 承载着全新的希望</em><a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#hyperlane-%E6%89%BF%E8%BD%BD%E7%9D%80%E5%85%A8%E6%96%B0%E7%9A%84%E5%B8%8C%E6%9C%9B" class="hash-link" aria-label="hyperlane-承载着全新的希望的直接链接" title="hyperlane-承载着全新的希望的直接链接">​</a></h3>
<p>若实现无需许可，开放互操作性，我们定能兑现加密行业的承诺。使命清晰而坚定：开放区块链生态，必须以开放互操作性为基石。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="过去的三年hyperlane-在默默地持续扩张"><em>过去的三年，Hyperlane 在默默地持续扩张</em><a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E8%BF%87%E5%8E%BB%E7%9A%84%E4%B8%89%E5%B9%B4hyperlane-%E5%9C%A8%E9%BB%98%E9%BB%98%E5%9C%B0%E6%8C%81%E7%BB%AD%E6%89%A9%E5%BC%A0" class="hash-link" aria-label="过去的三年hyperlane-在默默地持续扩张的直接链接" title="过去的三年hyperlane-在默默地持续扩张的直接链接">​</a></h3>
<p>凭借有限的资源、忠实社区与坚韧贡献者，Hyperlane 已接入超 140 条区块链，成为互操作领域覆盖最广的网络。基于 Hyperlane 构建的应用程序已实现链间消息传输超 800 万次。</p>
<p>通过 Warp Routes 桥接的交易量突破 50 亿美元大关，其中许多成为新链唯一的资产入口通道。</p>
<p>这一成就源于 Hyperlane 开创性的开发架构和使命。作为开放互操作性框架，Hyperlane 赋予任何人扩展、使用、贡献及定制网络的能力。我们拥抱的是一个真正无需许可的平台——开发者可在此轻松、安全地构建跨链应用与代币桥接。</p>
<!-- -->
<h1>一、HYPER 代币机制详解</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-核心运作原理">1. 核心运作原理<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#1-%E6%A0%B8%E5%BF%83%E8%BF%90%E4%BD%9C%E5%8E%9F%E7%90%86" class="hash-link" aria-label="1. 核心运作原理的直接链接" title="1. 核心运作原理的直接链接">​</a></h2>
<p>Hyperlane 从设计上是一个完全开放且无需许可的系统，任何开发者均可随时部署，以实现其链、资产或应用的互操作性。HYPER 代币作为核心协调机制，旨在激励开放生态中的多方参与者采取安全且符合集体利益的行为。</p>
<p><strong>HYPER 代币功能包括：</strong></p>
<ol>
<li>按使用量计算的奖励（Expansion Rewards）：协议中每发送一条跨链消息，系统将向参与者发放奖励，激励网络使用与生态拓展</li>
<li>质押奖励（Staking rewards ）：验证者通过安全完成跨链消息传递获得奖励；同时，为<a href="https://medium.com/hyperlane/modular-security-with-hyperlane-553c09411ef3" target="_blank" rel="noopener noreferrer">默认跨链安全模块（ISM）</a>提供经济安全保障的质押者也可获得奖励，需遵循质押/罚没机制。质押者可选择以流动性质押代币（stHYPER）形式领取奖励。
有关 HYPER 代币及其运行机制的更多细节，请参阅<a href="https://docs.hyperlane.xyz/docs/protocol-economics/intro" target="_blank" rel="noopener noreferrer">Hyperlane 官方文档</a></li>
</ol>
<p><img decoding="async" loading="lazy" src="https://image.yaco.email/hyperlane_airdrop%20(2).png" alt="hyperlane_airdrop (2)" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2代币分配原则">2.代币分配原则<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#2%E4%BB%A3%E5%B8%81%E5%88%86%E9%85%8D%E5%8E%9F%E5%88%99" class="hash-link" aria-label="2.代币分配原则的直接链接" title="2.代币分配原则的直接链接">​</a></h2>
<p>HYPER 代币的激励是围绕协议安全性、可靠性以及 Hyperlane 作为社区共有的开放互操作性标准的广泛采用。创世代币发行（TGE）将根据持币方过去及未来对网络利用率与生态贡献的权重进行分配。</p>
<p><strong>★扩展奖励（Expansion Rewards）</strong></p>
<p>未来四年内，按用户通过协议发送跨链消息的使用量比例，向使用 Hyperlane 发送消息或者代币跨链的用户以及项目方分配代币所有权作为奖励。</p>
<p><strong>★追溯空投奖励（ExpansionDrop）</strong></p>
<p>TGE 时，将向 Hyperlane 早期用户发放追溯性奖励。此类用户通过截至 2025 年 2 月 28 日 UTC 时间 23:59:59 的快照数据确认，累计发送约 860 万条消息，为 Hyperlane 早期发展奠定基础。</p>
<p><strong>★质押奖励（Staking Rewards）</strong></p>
<p>代币所有权将分配给以下两类参与者：</p>
<ol>
<li>验证者：负责验证 Hyperlane 连接链间的跨链消息；</li>
<li>质押者：为默认跨链安全模块（ISM）提供经济安全保障，其质押/罚没机制遵循协议规则。质押者可选择以流动性质押代币（Staked HYPER, stHYPER）形式领取奖励。</li>
</ol>
<p><strong>★基金会金库与战略启动资金（Foundation Treasury &amp; Strategic Launch Provision）</strong></p>
<ul>
<li>
<p>基金会金库：用于支持协议的长期治理、初始代币流动性提供，以及通过灵活手段（例如增加扩展奖励 Expansion Rewards）加速生态发展和飞轮效应的形成。</p>
</li>
<li>
<p>战略启动资金：部分资金将用来激励有特定交互及消息传输类型交互 Hyperlane 早期用户。</p>
</li>
</ul>
<p><strong>★核心团队与早期支持者（Core Team &amp; Early Backers）</strong></p>
<p>代币所有权将分配给那些为 Hyperlane 核心基础设施构建及采用推广作出关键贡献的成员，以激励其长期致力于提升协议并推动 Hyperlane 成为区块链互操作性领域的先锋。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-扩展奖励-expansion-rewards">3. 扩展奖励 （Expansion Rewards）<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#3-%E6%89%A9%E5%B1%95%E5%A5%96%E5%8A%B1-expansion-rewards" class="hash-link" aria-label="3. 扩展奖励 （Expansion Rewards）的直接链接" title="3. 扩展奖励 （Expansion Rewards）的直接链接">​</a></h3>
<p>Hyperlane 的扩展奖励将（Expansion Rewards）采用程序化分配模式，每季度发放，持续四年，按应用层消息使用量比例进行发放。默认情况下，分配至项目合作方的奖励中 85%将穿透直达终端用户，剩余 15%由项目合作方团队留存，且项目合作方可根据需求调整项目方和终端用户的比例。</p>
<p>采用 Hyperlane 作为标准桥或官方桥的区块链合作方，因推动 Hyperlane 成为开放互操作性的行业标准，将获得奖励权重加成。用户及项目合作方若连续持有协议代币 stHYPER，每季度将根据持有时长激活 HYPER 质押的加成倍数（最高达 1.6 倍），自 TGE 起保持最长不间断质押的参与者将享受最大乘数收益。早期通过预申领（Preclaims）选择在 TGE 接收 stHYPER 的用户，可优先实现最高乘数。</p>
<p>Hyperlane 基金会亦可能通过国库资金动态加速扩展奖励（Expansion Rewards），对符合 Hyperlane 利益的举措（如采用 Hyperlane 作为标准或官方桥、提供流动性支持、在 ISM 中集成独特功能或 hook 开发等）进行奖励加成，以构建高性能、高灵活性的开发者友好型互操作框架。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-质押安全与-sthyper">4. 质押安全与 stHYPER<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#4-%E8%B4%A8%E6%8A%BC%E5%AE%89%E5%85%A8%E4%B8%8E-sthyper" class="hash-link" aria-label="4. 质押安全与 stHYPER的直接链接" title="4. 质押安全与 stHYPER的直接链接">​</a></h3>
<p>用户可通过质押 HYPER 参与默认跨链安全模块（ISM）的验证者安全保障。质押/罚没机制确保 ISM 验证者仅对有效 Hyperlane 消息进行签名。任何质押罚没收益将用于补偿受害方。
用户通过托管协议参与经济安全质押时，将获得流动性质押凭证 stHYPER。不同链的质押奖励机制在申领、自动复利等规则上存在差异，具体细节请参阅<a href="https://docs.hyperlane.xyz/docs/protocol-economics/intro" target="_blank" rel="noopener noreferrer">Hyperlane 官方网页</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-女巫机制">5. 女巫机制<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#5-%E5%A5%B3%E5%B7%AB%E6%9C%BA%E5%88%B6" class="hash-link" aria-label="5. 女巫机制的直接链接" title="5. 女巫机制的直接链接">​</a></h3>
<p>为避免一刀切式封禁钱包，Hyperlane 开发了一套创新的女巫权重系统。合格的钱包地址将根据其被判定为女巫账户的可能性进行评分，若被标记为潜在女巫，则对其扩展空投奖励（Expansion Drop）施加负向乘数。只有与公开混沌实验室（Chaos Labs）女巫检测数据集匹配的地址会被完全排除在扩展空投（Expansion Drop）之外。其他地址的奖励奖励乘数范围为 0.0 至 1.0，具体权重基于以下三个判定因素：</p>
<ol>
<li>
<p>30% [0,1]：地址仅接收来自其他$HYPER 合格地址的交易或交互；</p>
</li>
<li>
<p>30% [0,0.5,1]：地址在 2024 年 1 月 1 日至 2025 年 2 月 28 日期间发送的交易总量（不限于 Hyperlane 交易或交互）分为三档：小于5笔、5-10,000笔 或 大于10,000 笔；</p>
</li>
<li>
<p>40% [0.0–1.0 连续值]：地址与其他 HYPER 合格地址的交互占比（例如：若 5%的交易总量来自其他 HYPER 合格地址，则得分为 0.05，对应 40%权重下奖励减少 2%）</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-代币分配与激励规则">6. 代币分配与激励规则<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#6-%E4%BB%A3%E5%B8%81%E5%88%86%E9%85%8D%E4%B8%8E%E6%BF%80%E5%8A%B1%E8%A7%84%E5%88%99" class="hash-link" aria-label="6. 代币分配与激励规则的直接链接" title="6. 代币分配与激励规则的直接链接">​</a></h3>
<p>HYPER 代币将在 TGE 时以锁定与全流通两种形式分配给各参与方，旨在通过长期利益驱动 Hyperlane 生态增长。HYPER 总供应量为 10 亿枚，将于 25 年内逐步释放完毕；TGE 流通供应量为 1.777 亿枚。</p>
<p><strong>★追溯空投奖励（Expansion Drop）</strong></p>
<p>TGE 阶段将释放总供应量的 7.5%作为追溯空投奖励，资金来源于扩展奖励池（Expansion Rewards）及 Hyperlane 基金会战略启动储备金。下文所述分配比例均基于 HYPER 总供应量计算。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二代币分配细则">二、代币分配细则<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E4%BA%8C%E4%BB%A3%E5%B8%81%E5%88%86%E9%85%8D%E7%BB%86%E5%88%99" class="hash-link" aria-label="二、代币分配细则的直接链接" title="二、代币分配细则的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://image.yaco.email/hyperlane_airdrop%20(3).png" alt="hyperlane_airdrop (3)" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="社区分配占总供应量-5702">社区分配（占总供应量 57.02%）<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E7%A4%BE%E5%8C%BA%E5%88%86%E9%85%8D%E5%8D%A0%E6%80%BB%E4%BE%9B%E5%BA%94%E9%87%8F-5702" class="hash-link" aria-label="社区分配（占总供应量 57.02%）的直接链接" title="社区分配（占总供应量 57.02%）的直接链接">​</a></h3>
<p><strong>✔扩展奖励（Expansion Rewards 25.50%）</strong></p>
<ol>
<li>按季度基于消息费用向项目合作方及用户分配。
2.TGE 阶段将释放本池 6.25%作为追溯奖励空投（Expansion Drop），其中 85%穿透至应用终端用户。符合条件的地址需满足：截至快照时支付至少 5 美元等值费用。支持 Hyperlane 基础设施的链、应用及协议终端用户可参与空投，具体名单可在文末查看。</li>
</ol>
<p><strong>✔战略启动资金（11.52%）</strong></p>
<ol>
<li>部分用于启动 HYPER 流动性及早期市场准入，并增强后续季度扩展奖励（Expansion Rewards）中的 OpenUSDT 铸造活动（含追溯激励）。</li>
<li>追溯奖励空投（Expansion Drop）：<!-- -->
<ol>
<li>1.09%：加成以 Hyperlane 为标准桥或官方互操作方案的链（如 Eclipse、Injective EVM 等）；</li>
<li>0.02%：奖励持有 Celestine Sloth Society 或 Mammoths NFT 的 Hyperlane GMP 地址；</li>
<li>0.10%：奖励 2024 年 1 月 30 日前在 Manta 或 Arbitrum 提供 TIA LP 流动性的地址（按流动性比例分配）；</li>
<li>0.04%：奖励 Pilot Academy 顶级贡献者等社区成员。</li>
</ol>
</li>
</ol>
<p><strong>✔质押奖励（20.00%）</strong></p>
<ol>
<li>TGE 无流通</li>
<li>25 年内线性释放，按季度增发。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="贡献者以及团队分配4298长期锁定">贡献者以及团队分配（42.98%长期锁定）<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E8%B4%A1%E7%8C%AE%E8%80%85%E4%BB%A5%E5%8F%8A%E5%9B%A2%E9%98%9F%E5%88%86%E9%85%8D4298%E9%95%BF%E6%9C%9F%E9%94%81%E5%AE%9A" class="hash-link" aria-label="贡献者以及团队分配（42.98%长期锁定）的直接链接" title="贡献者以及团队分配（42.98%长期锁定）的直接链接">​</a></h3>
<ol>
<li>
<p>核心团队（25.00%）</p>
<ul>
<li>TGE 无流通，12 个月后解锁 25%</li>
<li>剩余 75%分 24 个月线性释放（总周期 3 年）。</li>
</ul>
</li>
<li>
<p>Hyperlane 基金会金库（7.11%）</p>
<ul>
<li>除通过战略启动资金向社区分配 10.48%外，剩余资金用于长期协议治理、加速生态增长（如 Grants/R&amp;D）。</li>
<li>TGE 无流通,6 个月后开始解锁</li>
<li>30 个月内线性解锁（总周期 3 年）。</li>
</ul>
</li>
<li>
<p>早期支持者（10.87%）</p>
<ul>
<li>TGE 无流通，12 个月后解锁 25%</li>
<li>剩余 75%分 24 个月线性释放（总周期 3 年）。</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三代币发布相关时间表">三、代币发布相关时间表<a href="https://hyperlane.cc/blog/Hyperlane_Airdrop/#%E4%B8%89%E4%BB%A3%E5%B8%81%E5%8F%91%E5%B8%83%E7%9B%B8%E5%85%B3%E6%97%B6%E9%97%B4%E8%A1%A8" class="hash-link" aria-label="三、代币发布相关时间表的直接链接" title="三、代币发布相关时间表的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://image.yaco.email/hyperlane_airdrop%20(4).png" alt="hyperlane_airdrop (4)" class="img_ev3q"></p>
<ol>
<li>2025 年 2 月 28 日：快照</li>
<li>2025 年 4 月 3 日：通过Hyperlane 基金会网站启动预认领（Preclaim），用户可添加符合条件的地址、选择 HYPER/stHYPER 奖励类型并指定接收网络</li>
<li>2025 年 4 月 13 日（美东时间）23:59:59：预认领（Preclaim）阶段结束</li>
<li>2025 年 4 月 20 日 当周：TGE 启动，认领开始（Claim period）</li>
<li>2025 年 5 月 5 日（美东时间）23:59:59：认领截止</li>
</ol>
<p>未在对应阶段完成预认领或认领的追溯奖励空投（ExpansionDrop）将重新分配至未来 Hyperlane 生态激励计划。用户须在指定截止日期前完成预认领，并于 TGE 后认领期内操作方可获得奖励。</p>
<p><strong>由 Hyperlane 基础设施支持的链、应用及协议（非完整列表）</strong></p>
<p><strong>Chains：</strong></p>
<p>Ancient8、Appchain、B Squared、Artela、Cheesechain、Eclipse、Endurance、Flow、Form、Forma、Injective、LogX、Lumia、Mint、Oort、Prom、SonicSVM、SOON、Stride、Superseed、Swell、Treasure、Vana、Viction、Zerion</p>
<p><strong>Non-chains：</strong></p>
<p>Amphor、Caldera、Cod3x、Dinero、Eclipse Fi、Elixir、EtherFi、Jito、Kyros、Merkly、Nucleus、Mellow rstETH、Ponder、PumpBTC、Re7、Renzo、Superform、Velodrome</p>]]></content>
        <author>
            <name>marcus</name>
            <uri>https://x.com/marcus33l</uri>
        </author>
        <author>
            <name>hyperlane 中文</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <category label="hyperlane" term="hyperlane"/>
        <category label="跨链桥" term="跨链桥"/>
        <category label="代币机制" term="代币机制"/>
        <category label="空投标准" term="空投标准"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hyperlane 深度解析（2）：技术架构与安全机制]]></title>
        <id>https://hyperlane.cc/blog/in-depth-analysis-02/</id>
        <link href="https://hyperlane.cc/blog/in-depth-analysis-02/"/>
        <updated>2025-04-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[技术架构与安全机制]]></summary>
        <content type="html"><![CDATA[<p>跨链通信一直是区块链领域的一个难题，尤其是在安全性、去中心化和可扩展性之间找到平衡点。Hyperlane 通过其模块化设计和灵活的安全策略，提供了一种高效且安全的跨链通信方案。今天，我们就来深入探讨 Hyperlane 的技术架构和安全机制，看看它是如何解决这些挑战的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-的架构设计">Hyperlane 的架构设计<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#hyperlane-%E7%9A%84%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1" class="hash-link" aria-label="Hyperlane 的架构设计的直接链接" title="Hyperlane 的架构设计的直接链接">​</a></h2>
<p>Hyperlane 是第一个无需许可的互操作层，允许智能合约开发人员在区块链之间发送任意数据。开发人员可以使用 Hyperlane 移动代币、执行函数调用以及许多其他允许创建跨链应用程序的操作，这些应用程序可供任何区块链上的用户访问。用户通过邮箱智能合约与 Hyperlane 协议进行交互，该合约提供了链上消息传递接口来发送和接收链间消息。</p>
<p><img decoding="async" loading="lazy" alt="Flow" src="https://hyperlane.cc/assets/images/flow-812e7c3886e40b1ad041e6352233f916.png" width="1555" height="517" class="img_ev3q"></p>
<p>Hyperlane 采用模块化方法实现安全，允许应用程序配置和选择一系列Interchain 安全模块(ISM)。应用程序可以指定 ISM 来定制安全模型，以确保其与 Hyperlane 消息传递接口的集成安全。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="邮箱">邮箱<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E9%82%AE%E7%AE%B1" class="hash-link" aria-label="邮箱的直接链接" title="邮箱的直接链接">​</a></h2>
<p>Mailbox 合约是 Hyperlane 的消息存储和索引中心，负责管理跨链消息的生命周期，包括消息的发送、接收和状态更新。</p>
<p>Hyperlane <code>Mailbox</code> 支持的每条链上都部署了一个合约，其公开了一个用于发送和接收链间消息的链上 API。该网络 <code>Mailboxes</code> 促进了区块链之间的结缔组织，开发人员可以利用它来创建跨链应用程序，并为其现有应用程序添加跨链功能。</p>
<p><img decoding="async" loading="lazy" alt="Mailbox" src="https://hyperlane.cc/assets/images/mailbox-c60a4d5e1a288c460be6ffa98e01f560.png" width="988" height="148" class="img_ev3q"></p>
<p>Mailbox 合约需实现 <a href="https://github.com/hyperlane-xyz/hyperlane-monorepo/blob/main/solidity/contracts/interfaces/IMailbox.sol" target="_blank" rel="noopener noreferrer"><code>IMailbox</code></a> 接口，以下主要讲两个状态变异函数；<code>dispatch()</code> 和 <code>process()</code>，分别用于发送和接收消息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="发送消息">发送消息<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF" class="hash-link" aria-label="发送消息的直接链接" title="发送消息的直接链接">​</a></h3>
<p>为了发送链间消息，开发人员需要调用<code>Mailbox.dispatch()</code>。此函数将消息内容、目标链 ID 和收件人地址作为参数。每条消息都作为叶子插入到存储的增量 Merkle 树<code>Mailbox</code>中。Hyperlane 的权益证明协议使用此 Merkle 树来验证欺诈证明。</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint32</span><span class="token plain"> destinationDomain</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes32</span><span class="token plain"> recipientAddress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">calldata</span><span class="token plain"> messageBody</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">external</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">payable</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bytes32</span><span class="token plain"> messageId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>邮箱维护已传递值的映射，<code>messageId</code>以<strong>防止重放攻击</strong>。如果收到<code>messageId</code>已传递的消息，则该消息将被拒绝。</p>
<p>以下是 Soldity 版的发送消息示例：</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// send message from abstracttestnet to alephzeroevmtestnet TestRecipient</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMailbox mailbox </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">IMailbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"0x28f448885bEaaF662f8A9A6c9aF20fAd17A5a1DC"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">bytes32</span><span class="token plain"> messageId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mailbox</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dispatch</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">2039</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">"0x0000000000000000000000009EC79CA89DeF61BFa2f38cD4fCC137b9e49d60dD"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Hello, world"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="接收消息">接收消息<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E6%8E%A5%E6%94%B6%E6%B6%88%E6%81%AF" class="hash-link" aria-label="接收消息的直接链接" title="接收消息的直接链接">​</a></h3>
<p>为了传递链间消息，中继器调用<code>Mailbox.process()</code>。该函数将要传递的消息以及中继器可以指定的任意元数据作为参数。会将<code>Mailbox</code>消息和元数据传递给收件人的跨链安全模块 (ISM) 进行验证。如果 ISM 成功验证了消息，则会<code>Mailbox</code>通过调用 将消息传递给收件人<code>recipient.handle()</code>。</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint32</span><span class="token plain"> _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes32</span><span class="token plain"> _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">calldata</span><span class="token plain"> _message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">external</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">payable</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以下是 Soldity 版的接收消息示例：</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint32</span><span class="token plain"> _origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes32</span><span class="token plain"> _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bytes</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">calldata</span><span class="token plain"> _data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">external</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">payable</span><span class="token plain"> virtual override </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">emit</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ReceivedMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_origin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _sender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lastSender </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _sender</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lastData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当收到消息时，邮箱将在调用消息收件人之前使用跨链安全模块<code>handle</code>验证安全性。为了利用 Hyperlane 的模块化安全性，消息接收者可以指定自定义的 Interchain 安全模块来<strong>验证</strong>有关传入消息的任何内容。指定后，邮箱将遵循此 ISM。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="跨链安全模块">跨链安全模块<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E8%B7%A8%E9%93%BE%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97" class="hash-link" aria-label="跨链安全模块的直接链接" title="跨链安全模块的直接链接">​</a></h2>
<p><strong>Hyperlane 由跨链安全模块</strong> (Interchain Security Modules) 保护。ISM 是智能合约，负责验证在目标链上传递的跨链消息是否确实在源链上<em>发送。</em></p>
<p><img decoding="async" loading="lazy" alt="ISM" src="https://hyperlane.cc/assets/images/ISM-6a3fba76663045f766d6acb8d1ed5e09.png" width="514" height="421" class="img_ev3q"></p>
<p>开发人员可以使用 Mailbox 的默认 ISM，也可以指定自己的特定于应用程序的 ISM。特定于应用程序的 ISM 可以是：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置-configure">配置 (Configure)<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E9%85%8D%E7%BD%AE-configure" class="hash-link" aria-label="配置 (Configure)的直接链接" title="配置 (Configure)的直接链接">​</a></h3>
<p>Hyperlane 定义了一组预构建的 ISM。开发人员可以“现成地”部署任何这些合约，并使用自己的参数进行配置。</p>
<p>例如，想要增强链间安全性主权的应用程序开发人员可以部署配置了来自他们自己社区的验证器的<a href="https://docs.hyperlane.xyz/docs/protocol/ISM/multisig-ISM" target="_blank" rel="noopener noreferrer">Multisig ISM 。</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="组合-compose">组合 (Compose)<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E7%BB%84%E5%90%88-compose" class="hash-link" aria-label="组合 (Compose)的直接链接" title="组合 (Compose)的直接链接">​</a></h3>
<p>ISM 充当“安全乐高积木”。开发人员可以将不同的 ISM 混合搭配在一起，以编码最适合其需求的安全模型。</p>
<p>例如，需要额外安全性的应用程序开发人员可以部署一个<a href="https://docs.hyperlane.xyz/docs/protocol/ISM/aggregation-ISM" target="_blank" rel="noopener noreferrer">Aggregation ISM</a>，该 ISM 需要由来自 Hyperlane 社区的验证器配置的<a href="https://docs.hyperlane.xyz/docs/protocol/ISM/multisig-ISM" target="_blank" rel="noopener noreferrer">Multisig ISM进行验证，</a><strong>以及</strong>由 Wormhole ISM 进行验证，该 Wormhole ISM 可以验证<a href="https://wormhole.com/" target="_blank" rel="noopener noreferrer">Wormhole</a>验证器集的法定人数是否已验证该消息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="定制-customize">定制 (Customize)<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E5%AE%9A%E5%88%B6-customize" class="hash-link" aria-label="定制 (Customize)的直接链接" title="定制 (Customize)的直接链接">​</a></h3>
<p>ISM 是完全可定制的。开发人员可以<strong>编写自己的 ISM</strong>，根据其应用程序的需求进行定制。</p>
<p>例如，应用程序开发人员可以构建基于消息内容调整安全模型的 ISM。高价值和不频繁的消息（例如治理）可以通过优先考虑安全性而非延迟和 gas 成本的安全模型来验证。低价值和更频繁的消息可以通过优先考虑延迟和 gas 成本而非安全性的安全模型来验证。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="序列图">序列图<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E5%BA%8F%E5%88%97%E5%9B%BE" class="hash-link" aria-label="序列图的直接链接" title="序列图的直接链接">​</a></h3>
<p>以下显示了在目标链上验证和传递链间消息的简化序列图。</p>
<p><img decoding="async" loading="lazy" alt="Sequence diagram" src="https://hyperlane.cc/assets/images/sequence-diagram-511a53d4ae1bfb65fd2e98a94b50947d.png" width="985" height="605" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="中继者">中继者<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E4%B8%AD%E7%BB%A7%E8%80%85" class="hash-link" aria-label="中继者的直接链接" title="中继者的直接链接">​</a></h2>
<p>中继器通过将消息从源链传递到目标链来运行 Hyperlane 协议的传输层。根据接收者指定的链间安全模块 (ISM) ，可能需要元数据来证明消息的安全性，例如<a href="https://docs.hyperlane.xyz/docs/protocol/ISM/multisig-ISM" target="_blank" rel="noopener noreferrer">Multisig ISM</a> 的验证器签名、Merkle 证明、零知识证明等。因此，在尝试传递之前，中继器会收集任何特定于 ISM 的元数据。</p>
<blockquote>
<p>中继器将定期重试元数据收集和消息提交。这对于提高对中断的抵御能力非常重要，例如：未支付交付费用、中继器余额不足、目的地交易费用暂时飙升、验证器停机。</p>
</blockquote>
<p>消息发送者需要为在源链上的投递付费，中继器运营商有责任将收入重新平衡到目标链账户，以便始终能够支付投递交易费用。中继器不会从协议中获得直接的代币激励，但运营商可以配置其费用结构以提供其关键服务。</p>
<p>中继器由两个主要任务组成：每个来源的索引器和每个目的地的提交器。</p>
<p><img decoding="async" loading="lazy" alt="Replay Architecture" src="https://hyperlane.cc/assets/images/relayer-architecture-593774113bc38fb186389fbbc55758bc.png" width="1370" height="410" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="索引器-indexer">索引器 (Indexer)<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E7%B4%A2%E5%BC%95%E5%99%A8-indexer" class="hash-link" aria-label="索引器 (Indexer)的直接链接" title="索引器 (Indexer)的直接链接">​</a></h3>
<p>通过使用 RPC查询 Mailbox 合约事件，可以对新消息和历史消息进行索引。Gas付款也会被索引，以确认发送者已支付交付费用，并且某些 ISM 会使用额外的源链数据。索引器将数据写入本地数据库（RocksDB）作为缓存方式，并与提交任务进行通信 - 后者定期轮询数据库以检查是否已发送新消息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="提交者-submitter">提交者 (Submitter)<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E6%8F%90%E4%BA%A4%E8%80%85-submitter" class="hash-link" aria-label="提交者 (Submitter)的直接链接" title="提交者 (Submitter)的直接链接">​</a></h3>
<p>消息作为提交者的一部分经历四个阶段，这些阶段作为如下所述的独立任务产生。</p>
<table><thead><tr><th>提交者任务</th><th>描述</th></tr></thead><tbody><tr><td>消息处理器</td><td>轮询本地数据库以检查是否有任何未送达的消息并将其推送到准备步骤的队列。</td></tr><tr><td>准备任务</td><td>从队列中弹出消息，确保已支付 gas，获取任何元数据并模拟消息传递交易。如果模拟成功，则将消息推送到提交步骤的队列。否则，将消息推回到准备队列。</td></tr><tr><td>提交任务</td><td>从队列中弹出消息，并将交付交易发送到链上。交付尽可能分批进行。如果广播交易没有错误，则将消息推送到确认步骤的队列。否则，将消息推回到准备队列。</td></tr><tr><td>确认任务</td><td>等待最终结果；如果发生链重组，或者交付交易恢复，则消息将被推回到准备队列。</td></tr></tbody></table>
<p><code>Mailbox.process()</code>通过使用上述元数据调用目标链，将消息传递给接收者。</p>
<p>消息的重试次数根据指数退避策略决定其下一次传送尝试。目前，没有固定的最大重试次数，在此之后中继器将停止尝试处理消息。但是，这并不能保证无限次重试，运营商不应将此作为服务水平协议 (SLA)。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="验证器">验证器<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E9%AA%8C%E8%AF%81%E5%99%A8" class="hash-link" aria-label="验证器的直接链接" title="验证器的直接链接">​</a></h2>
<p>验证器作为 Multisig ISM 或<a href="https://docs.hyperlane.xyz/docs/protocol/economic-security/" target="_blank" rel="noopener noreferrer">经济安全模块</a>的一部分运行，实现 Hyperlane 协议的安全层。如果使用不同的 ISM，则不需要验证器。当Mailbox中发生新的调度时，它们负责通过签署 merkle 根（也称为检查点）来证明消息。必须向任何人（通常是中继器）提供签名，以便获取并与消息一起提交到目标链。</p>
<p>与许多其他协议不同，Hyperlane<strong>没有</strong>固定的验证器集。任何人都可以自由运行自己的验证器，只要接收方合约指定包含其验证器的 Multisig ISM 即可。</p>
<p>验证器检查点是公开的。这确保传输层是无需许可的，因为任何人都可以获取签名并调用<code>Mailbox.process()</code>来传递消息。中继器仅为消息发送者提供便利服务。</p>
<p>验证者只签署最终检查点很重要，以避免损害协议的安全性。签署重组的消息会导致经济安全模块被削减。验证者代理连接到单个链以检查新消息。如果验证多个链，则必须运行此代理的多个实例。</p>
<p>Hyperlane 正在将验证器开发为用 Rust 实现的二进制文件，任何人都可以轻松运行。在操作上，验证器需要运行此二进制文件，并可以访问他们正在验证的链的 RPC 提供程序或节点。我们希望大多数 Hyperlane 验证器都来自每个链的现有节点运营商社区。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="开发者工具">开发者工具<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7" class="hash-link" aria-label="开发者工具的直接链接" title="开发者工具的直接链接">​</a></h2>
<p>Hyperlane 提供了一些工具和开发者友好的接口，简化跨链应用的开发过程。开发者只需调用简单的 API 即可实现跨链功能，无需深入了解底层技术细节。</p>
<ul>
<li><strong>Hyperlane CLI</strong>: 是用于将 Hyperlane 合约部署到新链的官方命令行工具。它还包括用于与已部署合约和注册表交互的实用程序。</li>
<li><strong>SDK / 库 / 框架</strong>: <code>MailboxClient</code>、<code>Router</code>、<code>TypeCasts</code>、<code>Message</code>、<code>StandardHookMetadata</code> 等实现程序。</li>
</ul>
<p>虽然 Hyperlane 的公开文档目前侧重于 EVM 兼容性，但也为其他生态系统提供不同级别的支持。这些生态系统目前可能不具备完整的功能对等性或完整的工具集成（例如 TypeScript CLI 支持）。</p>
<ul>
<li>CosmWasm: 请参阅此处的 Hyperlane 的 <a href="https://github.com/many-things/cw-hyperlane" target="_blank" rel="noopener noreferrer">CosmWasm 实现</a>，由<a href="https://mitosis.org/" target="_blank" rel="noopener noreferrer">Mitosis 团队</a>实现和维护。按照<a href="https://github.com/many-things/cw-hyperlane/blob/main/DEPLOYMENT.md" target="_blank" rel="noopener noreferrer">此处的指南</a>了解如何部署到 Cosmos 应用链。</li>
<li>Sealevel:   Solana 虚拟机的 Hyperlane v3 现已在 Solana 和 Eclipse 上线，更多 Solana 汇总即将推出。您可以<a href="https://github.com/hyperlane-xyz/hyperlane-monorepo/blob/main/rust/sealevel/programs" target="_blank" rel="noopener noreferrer">在此处找到 Sealevel 合约实现</a>。</li>
<li>Cairo:  <a href="https://www.pragma.build/" target="_blank" rel="noopener noreferrer">Pragma 团队</a>已在 Cairo 中为 Starkware 实现了 Hyperlane 协议。您可以<a href="https://github.com/astraly-labs/hyperlane_starknet" target="_blank" rel="noopener noreferrer">在此处</a>找到正在进行的实现。</li>
<li>Move:  Hyperlane 已由<a href="https://movementlabs.xyz/" target="_blank" rel="noopener noreferrer">Movement Labs在 MoveVM 中实现。您可以</a><a href="https://github.com/movementlabsxyz/hyperlane-monorepo" target="_blank" rel="noopener noreferrer">在此处</a>找到正在进行的实现。这些 Move 合约已在 Movement 的 M1 测试网上上线。</li>
<li>Sway:  在这里查找正在进行的<a href="https://github.com/hyperlane-xyz/fuel-contracts" target="_blank" rel="noopener noreferrer">Sway 实施</a>。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="结论">结论<a href="https://hyperlane.cc/blog/in-depth-analysis-02/#%E7%BB%93%E8%AE%BA" class="hash-link" aria-label="结论的直接链接" title="结论的直接链接">​</a></h2>
<p>Hyperlane 通过模块化设计和灵活的安全策略，提供了一种高效、安全的跨链通信方案。未来，Hyperlane 将继续优化其技术架构，提升跨链通信的效率和安全性。通过不断的技术创新和优化，Hyperlane 有望成为跨链通信领域的领先解决方案。</p>]]></content>
        <author>
            <name>国子</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <author>
            <name>hyperlane 中文</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <category label="hyperlane" term="hyperlane"/>
        <category label="跨链桥" term="跨链桥"/>
        <category label="技术架构" term="技术架构"/>
        <category label="安全机制" term="安全机制"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hyperlane 深度解析（1）：全面认知、生态应用与竞品对比]]></title>
        <id>https://hyperlane.cc/blog/in-depth-analysis-01/</id>
        <link href="https://hyperlane.cc/blog/in-depth-analysis-01/"/>
        <updated>2025-03-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[全面认知、生态应用与竞品对比]]></summary>
        <content type="html"><![CDATA[<p>跨链通信在区块链生态系统中扮演着至关重要的角色。随着区块链技术的不断发展，单一链的局限性逐渐显现，跨链通信成为连接不同区块链网络的桥梁。当前市场上已有多种跨链解决方案，如 LayerZero、Axelar、Wormhole 等。这些方案各有优劣，但 Hyperlane 凭借其模块化设计和无许可部署的特性，提供了一种高度可定制化的跨链通信方案，使开发者能够更灵活地构建去中心化应用（DApp）。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-概览">Hyperlane 概览<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#hyperlane-%E6%A6%82%E8%A7%88" class="hash-link" aria-label="Hyperlane 概览的直接链接" title="Hyperlane 概览的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" alt="banner" src="https://hyperlane.cc/assets/images/banner-f65dade7e63f3babbdad2adcb5b63b5e.png" width="1219" height="401" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是-hyperlane">什么是 Hyperlane?<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E4%BB%80%E4%B9%88%E6%98%AF-hyperlane" class="hash-link" aria-label="什么是 Hyperlane?的直接链接" title="什么是 Hyperlane?的直接链接">​</a></h3>
<p><strong>Hyperlane</strong> 是第一个为模块化区块链堆栈构建的通用且无需许可的互操作性框架。任何人都可以将 Hyperlane 部署到任何区块链环境，无论是第 1 层、rollup 还是应用链，从而允许该链与已部署 Hyperlane 的任何其他链无缝通信。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="对于区块链开发者来说使用-hyperlane-有哪些好处">对于区块链开发者来说，使用 Hyperlane 有哪些好处？<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E5%AF%B9%E4%BA%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91%E8%80%85%E6%9D%A5%E8%AF%B4%E4%BD%BF%E7%94%A8-hyperlane-%E6%9C%89%E5%93%AA%E4%BA%9B%E5%A5%BD%E5%A4%84" class="hash-link" aria-label="对于区块链开发者来说，使用 Hyperlane 有哪些好处？的直接链接" title="对于区块链开发者来说，使用 Hyperlane 有哪些好处？的直接链接">​</a></h3>
<p>Hyperlane 为区块链和 dapp 开发者都带来了好处。</p>
<ul>
<li>对于区块链开发人员来说，Hyperlane 部署扩展了已部署 Hyperlane 的其他连接区块链对用户、资产和有价值状态的可访问性。</li>
<li>对于 dapp 开发者来说，Hyperlane 提供了跨多个区块链的无缝连接，允许开发者创建跨链网络效应和流动性，并允许用户与他们首选链上的应用程序进行交互。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-的核心组件">Hyperlane 的核心组件<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#hyperlane-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6" class="hash-link" aria-label="Hyperlane 的核心组件的直接链接" title="Hyperlane 的核心组件的直接链接">​</a></h3>
<ul>
<li><strong>Mailbox（邮箱）</strong>：负责存储和索引发送的跨链消息。每个链上的 Mailbox 合约是消息的入口和出口，确保消息的有序传递。</li>
<li><strong>Interchain Security Modules (ISMs)（跨链安全模块）</strong>：提供可定制的安全策略，决定哪些消息可以被目标链接受。开发者可以根据需求选择不同的安全验证机制，如多重签名、零知识证明等。</li>
<li><strong>Validators &amp; Relayers（验证人和中继器）</strong>：验证人负责确保消息的完整性，中继器则负责将消息从源链传递到目标链。两者共同协作，确保跨链消息的安全传输。</li>
<li><strong>Application Contracts（应用合约）</strong>：支持 DApp 直接集成 Hyperlane，发送和接收跨链消息。开发者可以通过简单的接口实现跨链功能。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-的工作原理">Hyperlane 的工作原理<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#hyperlane-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="hash-link" aria-label="Hyperlane 的工作原理的直接链接" title="Hyperlane 的工作原理的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Flow" src="https://hyperlane.cc/assets/images/flow-812e7c3886e40b1ad041e6352233f916.png" width="1555" height="517" class="img_ev3q"></p>
<p>Hyperlane 的跨链消息传递过程大致如下：</p>
<ol>
<li><strong>消息发送</strong>：用户在源链上调用 Hyperlane 的 <code>Mailbox</code> 合约，存储待发送的消息。消息包含目标链的地址、消息内容以及必要的元数据。</li>
<li><strong>消息中继</strong>：Relayer 监听 <code>Mailbox</code> 合约的事件，将消息传输至目标链。Relayer 通过签名和加密确保消息在传输过程中的安全性。</li>
<li><strong>消息验证</strong>：目标链上的 <code>Mailbox</code> 合约利用 ISM 进行安全验证，确保消息的有效性。ISM 可以根据预设的安全策略对消息进行多重验证。</li>
<li><strong>消息执行</strong>：验证通过后，目标链上的 DApp 合约接收并执行相应的消息。执行结果可以触发链上事件或状态更新。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-的优势">Hyperlane 的优势<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#hyperlane-%E7%9A%84%E4%BC%98%E5%8A%BF" class="hash-link" aria-label="Hyperlane 的优势的直接链接" title="Hyperlane 的优势的直接链接">​</a></h3>
<ul>
<li><strong>模块化设计</strong>：Hyperlane 的 ISM 允许开发者自由选择安全验证策略，不同的 DApp 可根据需求自定义跨链安全机制。</li>
<li><strong>广泛的兼容性</strong>：支持 EVM 链（如 Ethereum、Polygon、Avalanche），未来将扩展至非 EVM 生态（如 Cosmos、Substrate）。</li>
<li><strong>无需许可（Permissionless）</strong>：开发者可以自由部署 Hyperlane，而无需官方许可，任何链都可直接接入 Hyperlane，增强跨链互操作性。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="适用场景">适用场景<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF" class="hash-link" aria-label="适用场景的直接链接" title="适用场景的直接链接">​</a></h3>
<p>Hyperlane 可应用于多个跨链场景，包括但不限于：</p>
<ul>
<li><strong>跨链资产传输</strong>：在不同区块链之间传输 ERC-20 代币，或支持更复杂的 DeFi 资产流转。</li>
<li><strong>跨链 NFT 交易</strong>：允许 NFT 在多个链之间自由移动，提高流动性。</li>
<li><strong>跨链治理</strong>：DAO 组织可使用 Hyperlane 进行跨链投票和治理操作。</li>
<li><strong>跨链数据共享</strong>：不同链上的协议可以安全地共享价格数据、用户信息等。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="生态与应用案例">生态与应用案例<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E7%94%9F%E6%80%81%E4%B8%8E%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B" class="hash-link" aria-label="生态与应用案例的直接链接" title="生态与应用案例的直接链接">​</a></h2>
<p>Hyperlane 在跨链领域的影响力日益增强，开发者可以通过 Hyperlane 实现不同区块链之间的无缝通信。以下是 Hyperlane 的关键生态数据和应用成果：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="连接-100-条区块链">连接 100+ 条区块链<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E8%BF%9E%E6%8E%A5-100-%E6%9D%A1%E5%8C%BA%E5%9D%97%E9%93%BE" class="hash-link" aria-label="连接 100+ 条区块链的直接链接" title="连接 100+ 条区块链的直接链接">​</a></h4>
<p>Hyperlane 已经连接了超过 100 条区块链，涵盖了 EVM 链（如 Ethereum、Polygon、Avalanche）和非 EVM 链（如 Cosmos、Solana），Hyperlane 的广泛兼容性使其成为跨链通信的重要基础设施，支持多链生态的无缝互操作。</p>
<p><img decoding="async" loading="lazy" alt="chains" src="https://hyperlane.cc/assets/images/chains-8ef19bdad64ccb86b50fef722ba3ac07.png" width="1131" height="592" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="跨链资产转移总价值超过-50-亿美元">跨链资产转移总价值超过 50 亿美元<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E8%B7%A8%E9%93%BE%E8%B5%84%E4%BA%A7%E8%BD%AC%E7%A7%BB%E6%80%BB%E4%BB%B7%E5%80%BC%E8%B6%85%E8%BF%87-50-%E4%BA%BF%E7%BE%8E%E5%85%83" class="hash-link" aria-label="跨链资产转移总价值超过 50 亿美元的直接链接" title="跨链资产转移总价值超过 50 亿美元的直接链接">​</a></h4>
<p>通过 Hyperlane 进行的跨链资产转移总价值已超过 50 亿美元，涵盖了 DeFi、NFT 和跨链治理等多个领域，为大规模资产转移提供了安全、低成本的解决方案。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="支持-5-种虚拟机vms">支持 5+ 种虚拟机（VMs）<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E6%94%AF%E6%8C%81-5-%E7%A7%8D%E8%99%9A%E6%8B%9F%E6%9C%BAvms" class="hash-link" aria-label="支持 5+ 种虚拟机（VMs）的直接链接" title="支持 5+ 种虚拟机（VMs）的直接链接">​</a></h4>
<p>Hyperlane 支持多种虚拟机（VMs），包括 EVM、Cosmos SDK、Solana VM 等，未来还将扩展到更多非 EVM 生态（如 Polkadot、Near）。多虚拟机支持使 Hyperlane 能够覆盖更广泛的区块链生态，满足不同开发者的需求。</p>
<p><img decoding="async" loading="lazy" alt="Vms" src="https://hyperlane.cc/assets/images/vms-8cf3cc21aede8468c8c7a255816c8038.png" width="1199" height="294" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="与-rollup-堆栈中领先的协议和服务集成">与 Rollup 堆栈中领先的协议和服务集成<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E4%B8%8E-rollup-%E5%A0%86%E6%A0%88%E4%B8%AD%E9%A2%86%E5%85%88%E7%9A%84%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1%E9%9B%86%E6%88%90" class="hash-link" aria-label="与 Rollup 堆栈中领先的协议和服务集成的直接链接" title="与 Rollup 堆栈中领先的协议和服务集成的直接链接">​</a></h4>
<p>超过 20+ 个基础设施已经集成 Hyperlane，包括 Rollup 即服务、框架、序列发生器及数据可用性，展示了其在跨链通信领域的强大生态影响力。</p>
<p><img decoding="async" loading="lazy" alt="Infra" src="https://hyperlane.cc/assets/images/infra-6313bcda45e6fd327cfa80e6f4a36b35.png" width="1101" height="319" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hyperlane-vs-其他跨链协议对比分析">Hyperlane vs 其他跨链协议对比分析<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#hyperlane-vs-%E5%85%B6%E4%BB%96%E8%B7%A8%E9%93%BE%E5%8D%8F%E8%AE%AE%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90" class="hash-link" aria-label="Hyperlane vs 其他跨链协议对比分析的直接链接" title="Hyperlane vs 其他跨链协议对比分析的直接链接">​</a></h2>
<p>跨链通信是区块链生态中的重要组成部分，不同的跨链协议在技术架构、去中心化程度、安全机制等方面各有优劣。以下将对比 Hyperlane 与其他主流跨链协议（如 LayerZero、Axelar、Wormhole），分析其技术特点和应用场景。</p>
<table><thead><tr><th><strong>对比维度</strong></th><th><strong>Hyperlane</strong></th><th><strong>LayerZero</strong></th><th><strong>Axelar</strong></th><th><strong>Wormhole</strong></th></tr></thead><tbody><tr><td><strong>机制</strong></td><td>基于验证人和中继器，提供高度可定制的安全策略（ISM）。</td><td>基于轻客户端，通过链上轻节点实现跨链通信。</td><td>基于网关和中继器，提供跨链资产转移和消息传递。</td><td>基于验证人和中继器，支持跨链资产转移和消息传递。</td></tr><tr><td><strong>交易费用</strong></td><td>费用较低，适合高频跨链交易。</td><td>费用中等，适合中小型项目。</td><td>费用较高，适合大型跨链项目。</td><td>费用中等，适合跨链资产转移。</td></tr><tr><td><strong>延迟与吞吐量</strong></td><td>延迟较低，吞吐量较高，适合高频跨链交易。</td><td>延迟中等，吞吐量中等，适合中小型项目。</td><td>延迟较高，吞吐量较低，适合大型跨链项目。</td><td>延迟中等，吞吐量中等，适合跨链资产转移。</td></tr><tr><td><strong>安全性</strong></td><td>通过 ISM 提供多重验证机制，支持零知识证明、多重签名等多种安全策略。</td><td>安全性依赖于轻节点的去中心化程度。</td><td>安全性依赖于网关的去中心化程度。</td><td>安全性依赖于验证人的去中心化程度。</td></tr><tr><td><strong>去中心化程度</strong></td><td>高度去中心化，验证人和中继器由社区运行，ISM 支持自定义安全策略。</td><td>中等去中心化，依赖轻节点的分布和去中心化程度。</td><td>中等去中心化，依赖网关的去中心化程度。</td><td>中等去中心化，依赖验证人的去中心化程度。</td></tr><tr><td><strong>兼容性</strong></td><td>支持 EVM 链（如 Ethereum、Polygon、Avalanche），未来扩展至非 EVM 链（如 Cosmos）。</td><td>主要支持 EVM 链（如 Ethereum、Binance Smart Chain）。</td><td>主要支持 Cosmos 生态，逐步扩展至其他链。</td><td>主要支持 Solana 和 Ethereum，逐步扩展至其他链。</td></tr><tr><td><strong>市场采用情况</strong></td><td>已在 Ethereum、Solana、Cosmos 等多个生态中应用。</td><td>主要应用于 Ethereum 和 Binance Smart Chain。</td><td>主要应用于 Cosmos 生态。</td><td>主要应用于 Solana 和 Ethereum。</td></tr><tr><td><strong>开发者友好性</strong></td><td>提供模块化设计，支持自定义安全策略，开发者工具丰富。</td><td>提供轻客户端集成，开发者工具较为完善。</td><td>提供网关集成，开发者工具较为完善。</td><td>提供验证人机制，开发者工具较为完善。</td></tr><tr><td><strong>适用场景</strong></td><td>高频跨链交易、跨链资产转移、跨链治理、跨链数据共享。</td><td>中小型跨链项目、跨链资产转移。</td><td>大型跨链项目、跨链资产转移。</td><td>跨链资产转移、跨链消息传递。</td></tr></tbody></table>
<p>通过表格对比可以看出，Hyperlane 在 <strong>模块化设计</strong>、<strong>低延迟</strong>、<strong>高吞吐量</strong> 和 <strong>高度可定制的安全策略</strong> 方面具有显著优势，特别适合需要高频跨链交易和高安全性的项目。而其他协议如 LayerZero、Axelar 和 Wormhole 则在不同的场景中各有侧重，开发者可以根据项目需求选择合适的跨链方案。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="https://hyperlane.cc/blog/in-depth-analysis-01/#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>Hyperlane 作为一款模块化、可扩展的跨链协议，为开发者提供了灵活的工具，帮助他们构建更加互联互通的区块链应用。凭借其广泛的应用场景和强大的技术优势，Hyperlane 已经在多个区块链生态中取得了显著成果，成为连接多链生态的重要桥梁。随着跨链需求的不断增加，Hyperlane 的应用范围将进一步扩大，成为去中心化世界中不可或缺的基础设施。其未来的发展潜力巨大，值得长期关注。</p>]]></content>
        <author>
            <name>国子</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <author>
            <name>hyperlane 中文</name>
            <uri>https://hyperlane.cc</uri>
        </author>
        <category label="hyperlane" term="hyperlane"/>
        <category label="跨链桥" term="跨链桥"/>
        <category label="深度解析" term="深度解析"/>
        <category label="生态对比" term="生态对比"/>
    </entry>
</feed>